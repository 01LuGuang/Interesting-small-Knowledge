# Linux基础知识



## 登录与用户

登录：输入用户名和密码

注销：

- 输入logout
- Ctrl + D

用户提示：

- 超级用户：**#**
- 普通用户：**$**



## 关机和重启

​	关机和重启其实都是切换运行级别

关机：

- init 0
- halt
- shutdown -h +5

重启：

- init 6
- reboot
- shutdown -r +5

shutdown命令：

- -k 只是警告，不实际关机
- -r 关机后重新启动
- -h 关闭系统



```
ctrl + 放大字体 
ctrl - 减小字体
```



# Linux常用命令

| 命令         | 英文                 | 作用                   |
| ------------ | -------------------- | ---------------------- |
| ls           | list                 | 查看当前文件夹下的内容 |
| pwd          | print work directory | 输出当前目录路径       |
| cd 目录名    | change directory     | 切换文件夹             |
| touch 文件名 |                      | 如果文件不存在，新建   |
| mkdir 目录名 | make directory       | 创建目录               |
| rm 文件名    | remove               | 删除文件夹             |
| clear        |                      | 清屏                   |
|              |                      |                        |



## 文件和目录命令

| 命令                                                    | 英文        | 作用                                                        |
| ------------------------------------------------------- | ----------- | ----------------------------------------------------------- |
| ls                                                      |             |                                                             |
| cd                                                      |             |                                                             |
| touch                                                   |             |                                                             |
| rm                                                      |             |                                                             |
| mkdir                                                   |             |                                                             |
| [ cp](https://www.runoob.com/linux/linux-comm-cp.html)  | copy file   | 复制文件或目录                                              |
| [ mv](https://www.runoob.com/linux/linux-comm-mv.html)  | move file   | 文件或目录改名、或将文件或目录移入其它位置                  |
| [cat](https://www.runoob.com/linux/linux-comm-cat.html) | concatenate | 查看和连接文件                                              |
| more                                                    |             | 类似 cat ，不过会以一页一页的形式显示，更方便使用者逐页阅读 |
| .                                                       |             | 当前目录                                                    |
| ..                                                      |             | 上级目录                                                    |
|                                                         |             | 以 . 开头的文件是隐藏文件，需要参数 -a 才能看到             |



### ls常用选项&通配符使用

| 参数 | 含义                                             |
| ---- | ------------------------------------------------ |
| -a   | 显示指定目录下所有子目录与文件，包括**隐藏文件** |
| -l   | 以列表的方式显示文件的详细信息                   |
| -h   | 显示文件大小（K，M，G）                          |

| 通配符 | 含义                       |
| ------ | -------------------------- |
| *      | 代表任意个数个字符         |
| ？     | 代表任意一个字符，至少一个 |
| []     | 可以匹配字符组中的任意一个 |
| [abc]  | 匹配a，b，c中的任意一个    |
| [a-e]  | 匹配从a到e范围中的任意一个 |



### cd

| 命令       | 含义                                     |
| ---------- | ---------------------------------------- |
| cd（cd ~） | 切换到当前用户的主目录（/home/用户目录） |
| cd .       | 保持在当前目录                           |
| cd ..      | 切换到上级目录                           |
| cd -       | 最近两次目录之间来回切换                 |
|            |                                          |



### rm

- 使用时注意，rm删除的文件（夹）**无法恢复**！

| 选项 | 含义                                                   |
| ---- | ------------------------------------------------------ |
| -f   | 强制删除，无提示信息                                   |
| -r   | 递归地删除目录下的内容，**删除文件夹**时必须使用此参数 |





## 拷贝和移动文件

| 命令               | 英文 | 作用                     |
| ------------------ | ---- | ------------------------ |
| tree [目录名]      | tree | 输出目录结构             |
| cp 源文件 目标文件 | copy | 复制文件或者目录         |
| mv 源文件 目标文件 | move | 移动（重命名）文件或目录 |
|                    |      |                          |



### tree

| 选项 | 含义       |
| ---- | ---------- |
| -d   | 只显示目录 |



### cp

| 选项 | 含义                        |
| ---- | --------------------------- |
| -i   | 覆盖文件前有提示            |
| -r   | 复制目录时使用（类似rm -r） |



### mv

| 选项 | 含义           |
| ---- | -------------- |
| -i   | 覆盖文件前提示 |



## 查看文件内容

| 命令                | 英文        | 作用                                 |
| ------------------- | ----------- | ------------------------------------ |
| cat 文件名          | concatenate | 查看，追加文件内容，创建，合并，文件 |
| more 文件名         | more        | 可以分屏显示文件内容                 |
| grep 搜索文本文件名 | grep        | 搜索文本文件内容                     |
|                     |             |                                      |



### cat

| 选项 | 含义         |
| ---- | ------------ |
| -b   | 对非空行编号 |
| -n   | 对所有行编号 |



### more

| 操作健  | 功能           |
| ------- | -------------- |
| 空格键  | 显示下一页     |
| Enter键 | 滚动一行       |
| b       | 回滚一页       |
| f       | 前滚一页       |
| q       | 退出           |
| /word   | 搜索word字符串 |



### grep（强大的文本搜索）

- grep是Linux中一个强大的文本搜索工具

- grep允许对文本文件进行正则表达式查找

| 选项 | 含义                               |
| ---- | ---------------------------------- |
| -n   | 显示匹配行以及行号                 |
| -v   | 显示不包含匹配文本的所有行（取反） |
| -i   | 忽略大小写                         |
|      |                                    |

- 常用的模式查找

| 参数 | 含义                |
| ---- | ------------------- |
| ^a   | 搜索以a**开头**的行 |
| b$   | 搜索以b**结尾**的行 |



## 其他



### echo（！）

- 在终端中显示参数指定的文字，通常和**重定向**结合使用



### 重定向（！）

- Linux可以将命令执行结果重定向到一个文件
- 重定向将在**终端上的内容 输出/追加**到指定文件中

| 操作键 | 作用                       |
| ------ | -------------------------- |
| >      | 输出，会覆盖文件原有的内容 |
| >>     | 将内容追加到已有文件的末尾 |



### 管道 |

- Linux可以将一个命令的输出 通过管道 作为另一个命令的输入 

常用的管道命令：

- more：分屏显示内容
- grep：在命令执行结果的同时查询指定文本







# vim编辑器

三种模式：

| 模式     | 含义                                         |
| -------- | -------------------------------------------- |
| 命令模式 | 所有输入为命令，执行不同的功能，无法文本编辑 |
| 输入模式 | 可自由编辑                                   |
| 底线模式 | 以 ：开始，用于文件的保存和退出              |

![image-20250227155537040](C:\dataD\SCUStudy\Interesting-small-Knowledge\Linux\Linux基础.assets\image-20250227155537040.png)



**其他等用到再补充**





---

# 备份和压缩命令总结



## 常用的备份压缩命令

- tar 文件,目录打/解包：
  - tar -zcvf myusr.tar.gz mydoc 将mydoc目录打包后压缩,调用gzip压缩工具
  - tar -zxvf myusr.tar.gz 解压
- gzip 压缩或解压文件目录,后缀为 .gz
- compress 压缩或解压文件目录,后缀为 .Z
- bzip2 压缩或解压文件目录,后缀为 .bz2
- zcat 显示压缩的文本文件的内容
- xz 压缩或解压文件目录,后缀为 .xz



## 1. tar（归档工具）

### 作用
- 创建、提取或查看归档文件（`.tar` 文件）。
- 可以与压缩工具（如 `gzip`、`bzip2`）结合使用，创建压缩的归档文件。

### 常用参数
- **`-c`**：创建新的归档文件。
- **`-x`**：提取归档文件中的内容。
- **`-t`**：查看归档文件中的内容列表。
- **`-f`**：指定归档文件的名称。
- **`-z`**：与 `gzip` 结合，创建或解压 `.tar.gz` 文件。
- **`-j`**：与 `bzip2` 结合，创建或解压 `.tar.bz2` 文件。
- **`-v`**：在操作过程中显示详细信息。
- **`-C`**：指定提取文件的目标目录。

### 示例
```bash
tar -cvf archive.tar file1.txt file2.txt  # 创建归档文件 archive.tar
tar -xvf archive.tar                      # 提取归档文件中的内容
tar -tvf archive.tar                      # 查看归档文件中的内容列表

tar -czvf archive.tar.gz file1.txt file2.txt  # 创建压缩的归档文件 (.tar.gz)
tar -xzvf archive.tar.gz                      # 解压 .tar.gz 文件

tar -cjvf archive.tar.bz2 file1.txt file2.txt  # 创建压缩的归档文件 (.tar.bz2)
tar -xjvf archive.tar.bz2                      # 解压 .tar.bz2 文件

tar -cvf archive.tar -C /source/ .             # 归档指定目录下的所有文件
tar -xvf archive.tar -C /target/               # 提取归档文件到指定目录
```

## 2. gzip（压缩工具）

### 作用
- 压缩或解压文件，生成 `.gz` 文件。

### 常用参数
- **无参数**：压缩文件，生成 `.gz` 文件。
- **`-d`**：解压 `.gz` 文件。
- **`-k`**：压缩文件时保留原始文件。
- **`-f`**：强制压缩或解压，即使目标文件已存在也不提示。
- **`-v`**：显示压缩或解压过程中的详细信息。

### 示例
```bash
gzip file.txt          # 压缩文件 file.txt，生成 file.txt.gz
gzip -d file.txt.gz    # 解压文件 file.txt.gz
gzip -k file.txt       # 压缩文件 file.txt 并保留原始文件
gzip -f file.txt       # 强制压缩文件，即使目标文件已存在也不提示
gzip -v file.txt       # 压缩文件并显示详细信息
```

## 3. bzip2（压缩工具）

### 作用
- 压缩或解压文件，生成 `.bz2` 文件。

### 常用参数
- **无参数**：压缩文件，生成 `.bz2` 文件。
- **`-d`**：解压 `.bz2` 文件。
- **`-k`**：压缩文件时保留原始文件。
- **`-f`**：强制压缩或解压，即使目标文件已存在也不提示。
- **`-v`**：显示压缩或解压过程中的详细信息。

### 示例
```bash
bzip2 file.txt         # 压缩文件 file.txt，生成 file.txt.bz2
bzip2 -d file.txt.bz2  # 解压文件 file.txt.bz2
bzip2 -k file.txt      # 压缩文件 file.txt 并保留原始文件
bzip2 -f file.txt      # 强制压缩文件，即使目标文件已存在也不提示
bzip2 -v file.txt      # 压缩文件并显示详细信息
```

---

### 常见组合使用示例
- **创建 `.tar.gz` 文件**：
  ```bash
  tar -czvf archive.tar.gz /path/to/directory_or_file
  ```
- **解压 `.tar.gz` 文件**：
  ```bash
  tar -xzvf archive.tar.gz -C /target_directory
  ```
- **创建 `.tar.bz2` 文件**：
  ```bash
  tar -cjvf archive.tar.bz2 /path/to/directory_or_file
  ```
- **解压 `.tar.bz2` 文件**：
  ```bash
  tar -xjvf archive.tar.bz2 -C /target_directory
  ```

---





# 用户和用户组



## root用户

root用户（超级用户）拥有最大的系统操作权限。

- 在home目录外，一般普通用户只有只读和执行权限，无修改权限



### su & exit

```
切换到root用户
语法：su [-] [用户名]
```

- -可选，一般带上
- [用户名]，如果省略，表示切换到root用户
- exit用来退出当前用户，快捷键**ctrl + d**



### sudo

不建议长期使用root用户，避免损坏系统。

sudo命令可以为普通的命令授权（5mins），临时使用root用户执行命令。

```
语法：sudo 其他命令
```

有一些普通用户并没有权利使用sudo，需要机型sudo认证（请移步百度）。



## 用户权限

| 权限 | 缩写        | 数字代号 |
| ---- | ----------- | -------- |
| 读   | r（read）   | 4        |
| 写   | w（write）  | 2        |
| 执行 | x（excute） | 1        |

![image-20250303182523687](C:\dataD\SCUStudy\Interesting-small-Knowledge\Linux\Linux基础.assets\image-20250303182523687.png)

文件（或目录）；拥有者，组，其他用户的权限；硬链接数（表示访问该文件或目录的方式数量）；然后是拥有者，组名称；文件（目录）大小；创建时间；名称。



### chmod

[ chmod ](https://www.runoob.com/linux/linux-comm-chmod.html)用于修改用户/组 对文件/目录的权限

```

chmod +/-/= rwx 文件名/目录名
同时可以使用0-7数字来指定权限，用ugo来指定确定的权限对象（详情见上面链接）
```

- chmod 更改文件或目录的权限

  - chmod a+x test.sh  为脚本文件test.sh的所有用户增加可执行属性
  - chmod o–rwx test  取消其他用户对目录test的读、写和执行权限
  - chmod 755 file1  设置所有者完全权限（7 = 4+2+1），组和其他用户的读和执行权限（5 = 4+1）。

- chown 改变文件或目录的属主和属组

  - chown user1 file1  将文件file1的属主改为user1

  

**注意：**文件和目录的rwx权限对应有一些差别



### 组管理

**提示：** **创建组/删除组** 的命令都需要通过 `sudo` 执行

| 命令                      | 作用                  |
| ------------------------- | --------------------- |
| groupadd 组名             | 添加                  |
| groupdel 组名             | 删除                  |
| cat/etc/group             | 确认组信息            |
| chgrp -R 组名 文件/目录名 | 修改文件/目录的所属组 |

- 组信息保存在 /etc/group 文件中
- /etc 目录是专门用来保存**系统配置信息**的目录



## 用户管理



### 创建用户/设置密码/删除用户



| 命令                           | 作用         | 说明                                                         |
| ------------------------------ | ------------ | ------------------------------------------------------------ |
| useradd -m -g 组 新建用户名    | 添加用户     | 1.-m 自动创建用户家目录2.-g 指定用户所在的组，否则自动建立一个与用户同名的组 |
| passwd 用户名                  | 设置用户密码 | 普通用户passwd可以修改自己的账户密码                         |
| userdel -r 用户名              | 删除用户     | -r 选项会自动删除用户家目录                                  |
| cat /etc/passwd \| grep 用户名 | 确认用户信息 | 新建用户后，用户信息会保存在/etc/passwd文件中                |



### 查看用户信息



| 命令      | 作用                                       |
| --------- | ------------------------------------------ |
| id 用户名 | 查看用户UID（用户代号）和GID（组代号）信息 |
| who       | 查看当前所有登录的用户列表                 |
| whoami    | 查看当前登录用户的账户名                   |



### which（！）

- 查看命令所在的路径



### 切换用户

| 命令      | 作用                   | 说明                                                         |
| --------- | ---------------------- | ------------------------------------------------------------ |
| su - 用户 | 切换用户，同时切换目录 | - 可以切换到用户目录，否则保持位置不变，不接用户名，直接切换到root |
| exit      | 退出当前登录账户       |                                                              |



![image-20250303205515618](C:\dataD\SCUStudy\Interesting-small-Knowledge\Linux\Linux基础.assets\image-20250303205515618.png)



### 修改文件权限

| 命令  | 格式                        | 作用       |
| ----- | --------------------------- | ---------- |
| chown | chown 用户名 文件名/目录名  | 修改拥有者 |
| chgrp | chgrp -R 组名 文件名/目录名 | 修改组     |
| chmod | chmod -R 755 文件名/目录名  | 修改权限   |





# 系统信息



### 01 时间和日期

| 命令 | 作用                                     |
| ---- | ---------------------------------------- |
| date | 查看系统时间                             |
| cal  | calendar查看日历， -y 可以查看一年的日历 |



### 02 磁盘管理

| 命令           |                          | 作用                            |
| -------------- | ------------------------ | ------------------------------- |
| df -h          | -h 空间大小用K，M，G表示 | disk free 显示磁盘剩余空间      |
| du -h [目录名] |                          | disk usage 显示目录下的文件大小 |
| mount          |                          | 挂装文件系统                    |
| umount         |                          | 解挂文件系统                    |



### 03 进程信息



| 命令               | 作用                                 |
| ------------------ | ------------------------------------ |
| ps aux             | process status 查看进程的详细状况    |
| top                | 动态显示运行中的进程并排序（q 退出） |
| kill [-9] 进程代号 | 终止指定代号的进程，-9 表示强行终止  |



- ps只会显示当前用户通过终端启动的应用程序

| 选项 | 含义                                     |
| ---- | ---------------------------------------- |
| a    | 显示终端上所有的进程，包括其他用户的进程 |
| u    | 显示进程的详细信息                       |
| x    | 显示没有控制终端的进程                   |





强度来了（这部分知识基本是学OS的时候涉及，如果你是CS专业，当然不影响**卷王**读者自行学习:smile:）



# Linux进程



（1）**交互进程：**由一个shell启动的进程。交互进程既可在前台运行，也可以在后台运行，前者称为前台进程，后者称为后台进程。

（2）**批处理进程：**这种进程和终端没有联系，是一个进程系列，由多个进程按照指定的方式执行。

（3）**守护进程（Daemon）**：运行在后台的一种特殊进程，它在系统启动时启动，并在后台运行。



## Linux进程状态



- **运行态（TASK_RUNNING）**：进程准备运行，或正在运行
- **可中断等待态（TASK_INTERRUPTIBLE）**：进程等待特定事件
- **不可中断等待态（TASK_UNINTERRUPTIBLE）**：进程处于等待状态，但是此刻进程是不可中断的
- **僵尸态（TASK_ZOMBIE）**：进程已经停止运行，但在内存仍有结构(task_struct)
- **停止态（TASK_STOPPED/ TASK_TRACED ）**：进程暂停状态



## Linux 三种资源拷贝方式



- 共享：共享同一资源，如虚存空间、文件等。仅增加有关描述符的用户计数器。
- 直接拷贝：相同的结构，原样复制。
- **COW(Copy On Write，写时拷贝)**：在需要的时候才复制。



Linux提供了三个创建进程的系统调用：

- fork()	  用于普通进程的创建，采用COW方式。
- vfork()	 完全共享的创建，共享同一资源。
- clone()	由用户指定创建的方式。



## Linux进程控制函数



### 进程创建----fork（）

- fork ()函数通过系统调用创建一个与原来进程几乎完全相同的进程
  - 两个进程可以做完全相同的事
  - 根据初始参数或者传入的变量不同，两个进程也可以做不同的事。
- 一个进程调用fork()函数后，系统先给新的进程分配资源，例如存储数据和代码的空间。然后把原来的进程的所有值都复制到新的进程中，只有少数值与原来的进程的值不同。相当于克隆了一个自己。

- fork()的一个奇妙之处就是它仅仅被调用一次，却能够返回两次，它可能有三种不同的返回值：

  ①（>0）在父进程中，fork返回新创建子进程的进程ID；

  ②（=0）在子进程中，fork返回0；

  ③（<0）如果出现错误，fork返回一个负值；

- fork ()出错可能有两种原因：

  ①当前的进程数已经达到了系统规定的上限，这时errno的值被设置为EAGAIN。

  ②系统内存不足，这时errno的值被设置为ENOMEM。



## 进程标识符管理

```c
int getpid();	//取得当前进程的标识符（进程ID）。
int getppid();	//取得当前进程的父进程ID。
int getpgrp(); 	//取得当前进程的进程组标识符。
int getpgid(int pid); 	//将当前进程的进程组标识符改为当前进程的进程ID，使其成为进程组首进程，并返回这一新的进程组标识符。
```



## wait()/waitpid()函数😉 

- 作用：父进程查询子进程状态
- 进程一旦调用了wait()，就立即阻塞自己，由wait()自动分析是否当前进程的某个子进程已经退出，如果让它找到了这样一个已经变成僵尸态的子进程，wait ()就会收集这个子进程的信息，并把它彻底销毁后返回；如果没有找到这样一个子进程，wait ()就会一直阻塞在这里，直到有一个出现为止。
- **wait()要与fork()配套出现**，如果在使用fork()之前调用wait()，wait()的返回值则为-1，正常情况下wait()的返回值为子进程的PID
- 当**父进程没有使用wait()函数等待已终止的子进程**时,子进程就会进入一种无父进程清理自己尸体的状态，此时的子进程就是僵尸进程，不能在内核中清理尸体的情况



## 加载新的进程映像——exec函数族

- 创建的进程往往希望它能执行新的程序，在Linux中，进程创建和加载新进程映像是分离操作的。
- 在Linux中，当创建一个进程后，通常使用exec系列函数将子进程替换成新的进程映像。
- 注意：Linux中并不存在一个exec()的函数形式，exec指的是一组函数，一共有6个，分别是：

```c
#include <unistd.h> 
int execl(const char *path, const char *arg, ...); 
int execlp(const char *file, const char *arg, ...); 
int execle(const char *path, const char *arg, ..., char *const envp[]); 
int execv(const char *path, char *const argv[]); 
int execvp(const char *file, char *const argv[]); 
int execve(const char *path, char *const argv[], char *const envp[]);
其中，只有execve()是真正意义上的系统调用，其它都是在此基础上经过包装的库函数
```



- exec函数族的作用是**根据指定的文件名找到可执行文件，并用它来取代调用进程的内容**，换句话说，就是在调用进程内部执行一个可执行文件。这里的可执行文件既可以是二进制文件，也可以是任何Linux下可执行的脚本文件。
- 与一般情况不同，**exec函数族的函数执行成功后不会返回，因为调用进程的实体，包括代码段，数据段和堆栈等都已经被新的内容取代**，只留下进程ID等一些表面上的信息仍保持原样。



:sunny::sunny::sunny:如果你需要一些练习，这里提供了少量的题目：

（1）编写一个C 程序，并使用系统调用fork()创建一个子进程。要求如下：①在子进程中分别输出当前进程为子进程的提示、当前进程的PID 和父进程的PID、根据用户输入确定当前进程的返回值、退出提示等信息。②在父进程中分别输出当前进程为父进程的提示、当前进程的PID 和子进程的PID、等待子进程退出后获得的返回值、退出提示等信息。

```c
#include <unistd.h>
#include <sys/types.h>
#include <errno.h>
#include <sys/wait.h>
#include <stdlib.h>
#include <stdio.h>

int main() {
    pid_t childpid;
    int retval;
    int status;

    childpid = fork(); // 子进程从这里开始执行，复制了父进程的所有状态，包括变量

    if (childpid >= 0) {
        if (childpid == 0) {
            // 子进程逻辑
            printf("CHILD: I am the child process!\n");
            printf("CHILD: Here's my PID: %d\n", getpid());         // 获取子进程 PID
            printf("CHILD: My parent's PID is: %d\n", getppid());    // 获取父进程 PID
            printf("CHILD: The value of fork return is: %d\n", childpid);
            printf("CHILD: Sleep for 1 second...\n");
            sleep(1);
            printf("CHILD: Enter an exit value (0~255): ");
            scanf("%d", &retval);
            printf("CHILD: Goodbye!\n");
            exit(retval);  // 子进程返回用户指定的退出码
        } else {
            // 父进程逻辑
            printf("Parent: I am the parent process!\n");
            printf("Parent: Here's my PID: %d\n", getpid());         // 获取父进程 PID
            printf("Parent: The value of my child's PID is: %d\n", childpid);
            printf("Parent: I will now wait for my child to exit.\n");

            wait(&status);  // 等待子进程结束，并获取退出状态

            printf("Parent: Child's exit code is: %d\n", WEXITSTATUS(status));
            printf("Parent: Goodbye!\n");
            exit(0);
        }
    } else {
        // fork失败
        perror("fork error!");
        exit(1);
    }
}

```

（2）编写另一个C 程序，使用系统调用fork()以创建一个子进程，并使用这个子进程调用exec 函数族以执行系统命令ls。





## Linux进程调度

- Linux 中有一个总的调度结构，称之为调度器类（scheduler class）

  - 允许不同的可动态添加的调度算法并存，总调度器根据调度器类的优先顺序，依次挑选调度器类中的进程进行调度。
  - 确定调度器类后，再使用该调度器类的调度算法（调度策略）进行内部调度。

- 调度器类的优先级顺序为：

  ​                                                              **Stop_Task > Real_Time > Fair > Idle_Task**        

  其中，Fair和Real_time最常用，分别采用CFS（完全公平调度算法）调度算法的默认调度类和实时调度类



![image-20250415210054980](C:\dataD\SCUStudy\Interesting-small-Knowledge\Linux\Linux基础.assets\image-20250415210054980.png)
